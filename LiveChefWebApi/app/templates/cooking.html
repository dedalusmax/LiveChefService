<div data-bind="with: cooking" class="cooking-component">

    <div class="header">
        <!-- ko if: !chefIsMe -->
        <button class="btn btn-default" data-bind="click: returnToMain">Return</button>
        <!-- /ko -->
        <!-- ko if: chefIsMe -->
        <button class="btn btn-warning" data-bind="click: giveUp">Give up!</button>
        <!-- /ko -->
    </div>

    <div class="row anti-row">

        <div class="col-sm-4">
            <h4>Cooking details</h4>
            <div data-bind="template: { name: 'recipe-card', data: dish }"></div>
        </div>

        <!-- ko if: chefIsMe -->

        <div class="col-sm-4">
            <h4>Broadcast options</h4>
            <button class="btn btn-primary" data-bind="click: startBroadcast, visible: !isBroadcasting()">Start broadcast</button>
            <button class="btn btn-default" data-bind="click: stopBroadcast, visible: isBroadcasting">Stop broadcast</button>
        </div>

        <div class="col-sm-4" data-bind="with: $parent.communicator">

            <h4>My cooking is emitting live!</h4>
            <div class="card fullsize">
                <div class="card-body" data-bind="if: intendedAction() == 1">
                    <video id="localVideo" autoplay controls></video>
                </div>
                <div class="card-body" data-bind="if: intendedAction() == 2">
                    <audio id="localAudio" autoplay></audio>
                </div>
                <div class="card-footer">
                    <span class="glyphicon glyphicon-camera glyph-button" aria-hidden="true" data-bind="click: takeSnapshot"></span>
                    <label>Take a snapshot</label>
                    <div>
                        <span class="glyphicon glyphicon-comment" aria-hidden="true" data-bind="style: { color: settings.allowChat ? 'white' : 'grey' }"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- /ko -->
        <!-- ko if: !chefIsMe -->

        <div class="col-sm-4">
            <h4>Media stream from the presenter</h4>
            <div class="card fullsize">
                <div class="card-body">
                    <video class="fullsize" autoplay controls></video>
                </div>
                <div class="card-footer">
                    <div>
                        <span class="glyphicon glyphicon-camera" aria-hidden="true" data-bind="style: { color: settings.usecamera ? 'white' : 'grey' }"></span>
                        <span class="glyphicon glyphicon-volume-up" aria-hidden="true" data-bind="style: { color: settings.usemicrophone ? 'white' : 'grey' }"></span>
                        <span class="glyphicon glyphicon-comment" aria-hidden="true" data-bind="style: { color: settings.allowchat ? 'white' : 'grey' }"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- /ko -->

        <div class="row anti-row">
            <div class="col-sm-4" data-bind="if: snapshots.length > 0">
                <h4>Snapshots</h4>
                <div class="card-deck" data-bind="foreach: snapshots">
                    <div class="card">
                        <div class="card-body">
                            <canvas class="fullsize" data-bind="attr: { id: snapshotId, width: width, height: height }"></canvas>
                        </div>
                        <div class="card-footer">
                            <div class="time row">
                                <div class="col-sm-10">
                                    <span class="glyphicon glyphicon-time" aria-hidden="true"></span>
                                    <small data-bind="text: 'Taken at: ' + timeTakenText"></small>
                                </div>
                                <div class="col-sm-2">
                                    <span class="glyphicon glyphicon-trash" aria-hidden="true" data-bind="click: $parent.removeSnapshot.bind($data, $parent)"></span>
                                </div>
                            </div>
                            <div>
                                <div data-bind="if: editMode">
                                    <div class="col-sm-10">
                                        <textarea data-bind="value: description" />
                                    </div>
                                    <div class="col-sm-2">
                                        <span class="glyphicon glyphicon-check" aria-hidden="true" data-bind="click: $parent.toggleEditMode"></span>
                                    </div>
                                </div>
                                <div data-bind="if: editMode() == false">
                                    <div class="col-sm-10">
                                        <small data-bind="text: description"></small>
                                    </div>
                                    <div class="col-sm-2">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true" data-bind="click: $parent.toggleEditMode"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
